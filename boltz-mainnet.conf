# Boltz Backend Configuration - Mainnet
# Integration with existing Lightning.space infrastructure

# Network Configuration - MUST be at top level before any sections!
network = "mainnet"

[api]
host = "0.0.0.0"
port = 9001
allowedCors = ["*"]

[grpc]
host = "0.0.0.0"
port = 9000

# Sidecar Configuration (Rust component)
[sidecar]
  [sidecar.grpc]
  host = "127.0.0.1"
  port = 9003
  certificates = "/Users/customer/Documents/GitHub/BoltzExchange/boltz-backend/sidecar/certificates"

  [sidecar.ws]
  host = "0.0.0.0"
  port = 9004

  [sidecar.api]
  host = "0.0.0.0"
  port = 9005

# PostgreSQL Database
[postgres]
host = "localhost"  # Running locally, not in Docker
port = 5432
database = "boltz"
username = "boltz"
password = "boltz"

# Redis Cache (optional but recommended)
[cache]
redisEndpoint = "redis://localhost:6379"

# Bitcoin/Lightning Configuration
[[currencies]]
symbol = "BTC"
network = "mainnet"
derivationPath = "m/0"

# Wallet balances - adjusted for testing
minWalletBalance = 100_000  # 0.001 BTC (100k sats)
minChannelBalance = 100_000  # 0.001 BTC (100k sats)

# Swap limits
maxSwapAmount = 10_000_000  # 0.1 BTC maximum
minSwapAmount = 2_500       # 2,500 sats minimum (currency level - for all BTC swaps)
maxZeroConfAmount = 0       # Disable 0-conf for security

  # Bitcoin Core Configuration
  [currencies.chain]
  # Running locally, use localhost
  host = "localhost"
  port = 8332

  # RPC Authentication
  user = "dfx"
  password = ".$trengGehe1m."

  # ZMQ endpoints for blockchain notifications
  zmqpubrawtx = "tcp://localhost:28333"
  zmqpubrawblock = "tcp://localhost:28332"

  # Bitcoin wallet name
  wallet = "testwallet"

  # LND Configuration
  [currencies.lnd]
  # Running locally, use localhost
  host = "localhost"
  port = 10009  # gRPC port (not REST 8080!)

  # Credentials - mounted from Docker volumes
  certpath = "/Users/customer/Documents/GitHub/BoltzExchange/boltz-backend/.lnd-credentials/tls.cert"
  macaroonpath = "/Users/customer/Documents/GitHub/BoltzExchange/boltz-backend/.lnd-credentials/data/chain/bitcoin/mainnet/admin.macaroon"

# Swap Pair Configuration: BTC/BTC (Lightning <-> OnChain)
[[pairs]]
base = "BTC"
quote = "BTC"
rate = 1  # 1:1 exchange rate

# Fee configuration (in percent)
fee = 0.5          # 0.5% service fee
swapInFee = 0.25   # 0.25% for submarine swaps (chain -> lightning)

# Swap amount limits (in satoshis)
maxSwapAmount = 10_000_000  # 0.1 BTC
minSwapAmount = 2_500       # 2,500 sats (pair level)

  # Submarine Swap specific settings (Chain -> Lightning)
  [pairs.submarineSwap]
  minSwapAmount = 10_000   # Minimum for submarine swaps (needs high limit due to on-chain fees)

  # Reverse Swap specific settings (Lightning -> Chain)
  [pairs.reverseSwap]
  minSwapAmount = 2_500    # Minimum for reverse swaps (lower fees, no input tx)

  # Timeout configuration (in minutes!)
  [pairs.timeoutDelta]
  chain = 1440        # Chain swap timeout (~24 hours = 144 blocks)
  reverse = 1440      # ~24 hours for reverse swaps (lightning -> chain)
  swapMinimal = 1440  # Minimum timeout for submarine swaps (~24 hours = 144 blocks)
  swapMaximal = 2880  # Maximum timeout (~48 hours = 288 blocks)
  swapTaproot = 100800  # 1 week for taproot swaps (10080 blocks)

# Swap Pair Configuration: BTC/RBTC (Lightning BTC <-> RSK RBTC)
[[pairs]]
base = "BTC"
quote = "RBTC"
rate = 1  # 1:1 peg between BTC and RBTC
fee = 0.25
swapInFee = 0.1

maxSwapAmount = 10_000_000  # 0.1 BTC/RBTC
minSwapAmount = 2_500       # 2,500 sats minimum (Rootstock has lower fees)

  [pairs.timeoutDelta]
  chain = 1440        # Chain swap timeout (~24 hours)
  reverse = 1440      # Reverse swap timeout (Lightning -> RBTC)
  swapMinimal = 1440  # Minimum timeout
  swapMaximal = 2880  # Maximum timeout
  swapTaproot = 10080

[[pairs]]
base = "BTC"
quote = "cBTC"
rate = 1  # 1:1 peg between BTC and cBTC
fee = 0.25
swapInFee = 0.1

maxSwapAmount = 10_000_000  # 0.1 BTC/cBTC
minSwapAmount = 2_500       # 2,500 sats minimum (Citrea Testnet has low fees)

  [pairs.timeoutDelta]
  chain = 60          # Chain swap timeout (~1 hour, due to fast 2s blocks)
  reverse = 180       # Reverse swap timeout (Lightning -> cBTC) - increased for CLTV requirements
  swapMinimal = 800   # Minimum timeout (~13.3 hours) - minimum for Lightning CLTV (80 blocks Ã— 10 min)
  swapMaximal = 1000  # Maximum timeout (~16.7 hours) - allows 100 Bitcoin blocks CLTV
  swapTaproot = 1000  # Taproot timeout (~16.7 hours)

# RSK (Rootstock) Configuration
[rsk]
networkName = "RSK Mainnet"
providerEndpoint = "https://rootstock-mainnet.g.alchemy.com/v2/GEcs0OPJCkuWGvBLu5L6q"

 [[rsk.contracts]]
 etherSwap = "0x3d9cc5780CA1db78760ad3D35458509178A85A4A"
 erc20Swap = "0x7d5a2187CC8EF75f8822daB0E8C9a2DB147BA045"

 [[rsk.tokens]]
 symbol = "RBTC"

 maxSwapAmount = 10_000_000
 minSwapAmount = 2_500  # Lower fees on Rootstock

 minWalletBalance = 100_000

# Citrea Testnet Configuration
[citrea]
networkName = "Citrea Testnet"
providerEndpoint = "https://rpc.testnet.citrea.xyz"

 [[citrea.contracts]]
 etherSwap = "0x7acB49196eB8D077474bCA85C6aF8D59D9136593"
 erc20Swap = "0x5370d7F7956Cf0e97f5903CB0Ac56a465E8754f7"

 [[citrea.tokens]]
 symbol = "cBTC"

 maxSwapAmount = 10_000_000
 minSwapAmount = 2_500  # Low fees on Citrea Testnet

 minWalletBalance = 100_000
